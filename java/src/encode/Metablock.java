// Generated by Haxe 3.4.0
package encode;

import haxe.root.*;

@SuppressWarnings(value={"rawtypes", "unchecked"})
public class Metablock extends haxe.lang.HxObject
{
	public Metablock(haxe.lang.EmptyObject empty)
	{
	}
	
	
	public Metablock()
	{
		//line 223 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.Metablock.__hx_ctor_encode_Metablock(this);
	}
	
	
	public static void __hx_ctor_encode_Metablock(encode.Metablock __hx_this)
	{
	}
	
	
	public static void BuildMetaBlock(int[] ringbuffer, int pos, int mask, int prev_byte, int prev_byte2, haxe.root.Array<encode.command.Command> cmds, int num_commands, int literal_context_mode, encode.metablock.MetaBlockSplit mb)
	{
		//line 29 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.Block_splitter.SplitBlock(cmds, num_commands, ringbuffer, ( pos & mask ), mb.literal_split, mb.command_split, mb.distance_split);
		//line 35 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		haxe.root.Array<java.lang.Object> literal_context_modes = new haxe.root.Array<java.lang.Object>();
		//line 36 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 36 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g1 = 0;
			//line 36 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g = mb.literal_split.num_types;
			//line 36 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g1 < _g ))
			{
				//line 36 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i = _g1++;
				//line 37 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				literal_context_modes.__set(i, literal_context_mode);
			}
			
		}
		
		//line 39 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int num_literal_contexts = ( mb.literal_split.num_types << 6 );
		//line 41 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int num_distance_contexts = ( mb.distance_split.num_types << 2 );
		//line 43 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		haxe.root.Array<encode.histogram.Histogram> literal_histograms = new haxe.root.Array<encode.histogram.Histogram>();
		//line 44 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 44 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g11 = 0;
			//line 44 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g11 < num_literal_contexts ))
			{
				//line 44 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				 ++ _g11;
				//line 45 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				literal_histograms.push(new encode.histogram.Histogram(((int) (encode.Histogram_functions.HistogramLiteralInt) )));
			}
			
		}
		
		//line 46 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		mb.command_histograms = new haxe.root.Array<encode.histogram.Histogram>(new encode.histogram.Histogram[]{});
		//line 47 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 47 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g12 = 0;
			//line 47 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g2 = mb.command_split.num_types;
			//line 47 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g12 < _g2 ))
			{
				//line 47 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				 ++ _g12;
				//line 48 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.command_histograms.push(new encode.histogram.Histogram(((int) (encode.Histogram_functions.HistogramCommandInt) )));
			}
			
		}
		
		//line 49 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		haxe.root.Array<encode.histogram.Histogram> distance_histograms = new haxe.root.Array<encode.histogram.Histogram>();
		//line 50 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 50 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g13 = 0;
			//line 50 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g13 < num_distance_contexts ))
			{
				//line 50 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				 ++ _g13;
				//line 51 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				distance_histograms.push(new encode.histogram.Histogram(((int) (encode.Histogram_functions.HistogramDistanceInt) )));
			}
			
		}
		
		//line 52 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.Histogram_functions.BuildHistograms(cmds, num_commands, mb.literal_split, mb.command_split, mb.distance_split, ringbuffer, pos, mask, prev_byte, prev_byte2, literal_context_modes, literal_histograms, mb.command_histograms, distance_histograms);
		//line 69 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 69 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g14 = 0;
			//line 69 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g3 = literal_histograms.length;
			//line 69 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g14 < _g3 ))
			{
				//line 69 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i1 = _g14++;
				//line 70 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.literal_histograms.__set(i1, new encode.histogram.Histogram(((int) (encode.Histogram_functions.HistogramLiteralInt) )));
				//line 71 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.literal_histograms.__get(i1).bit_cost_ = literal_histograms.__get(i1).bit_cost_;
				//line 72 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				{
					//line 72 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g31 = 0;
					//line 72 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g21 = ((int[]) (literal_histograms.__get(i1).data_) ).length;
					//line 72 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					while (( _g31 < _g21 ))
					{
						//line 72 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						int a = _g31++;
						//line 73 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						((int[]) (mb.literal_histograms.__get(i1).data_) )[a] = ((int[]) (literal_histograms.__get(i1).data_) )[a];
					}
					
				}
				
				//line 74 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.literal_histograms.__get(i1).kDataSize = literal_histograms.__get(i1).kDataSize;
				//line 75 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.literal_histograms.__get(i1).total_count_ = literal_histograms.__get(i1).total_count_;
			}
			
		}
		
		//line 77 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int[] this1 = new int[( 64 * mb.literal_split.num_types )];
		//line 77 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		mb.literal_context_map = ((int[]) (this1) );
		//line 78 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.Cluster.ClusterHistograms(literal_histograms, 64, mb.literal_split.num_types, 256, mb.literal_histograms, encode.Histogram_functions.HistogramLiteralInt, mb.literal_context_map);
		//line 86 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 86 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g15 = 0;
			//line 86 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g4 = distance_histograms.length;
			//line 86 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g15 < _g4 ))
			{
				//line 86 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i2 = _g15++;
				//line 87 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.distance_histograms.__set(i2, new encode.histogram.Histogram(((int) (encode.Histogram_functions.HistogramDistanceInt) )));
				//line 88 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.distance_histograms.__get(i2).bit_cost_ = distance_histograms.__get(i2).bit_cost_;
				//line 89 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				{
					//line 89 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g32 = 0;
					//line 89 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g22 = ((int[]) (distance_histograms.__get(i2).data_) ).length;
					//line 89 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					while (( _g32 < _g22 ))
					{
						//line 89 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						int a1 = _g32++;
						//line 90 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						((int[]) (mb.distance_histograms.__get(i2).data_) )[a1] = ((int[]) (distance_histograms.__get(i2).data_) )[a1];
					}
					
				}
				
				//line 91 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.distance_histograms.__get(i2).kDataSize = distance_histograms.__get(i2).kDataSize;
				//line 92 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				mb.distance_histograms.__get(i2).total_count_ = distance_histograms.__get(i2).total_count_;
			}
			
		}
		
		//line 94 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int[] this2 = new int[( 4 * mb.distance_split.num_types )];
		//line 94 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		mb.distance_context_map = ((int[]) (this2) );
		//line 95 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.Cluster.ClusterHistograms(distance_histograms, 4, mb.distance_split.num_types, 256, mb.distance_histograms, encode.Histogram_functions.HistogramDistanceInt, mb.distance_context_map);
	}
	
	
	public static void BuildMetaBlockGreedy(int[] ringbuffer, int pos, int mask, haxe.root.Array<encode.command.Command> commands, int n_commands, encode.metablock.MetaBlockSplit mb)
	{
		//line 109 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int num_literals = 0;
		//line 110 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 110 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g1 = 0;
			//line 110 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g1 < n_commands ))
			{
				//line 110 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i = _g1++;
				//line 111 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				num_literals += commands.__get(i).insert_len_;
			}
			
		}
		
		//line 114 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.metablock.BlockSplitter lit_blocks = new encode.metablock.BlockSplitter(encode.Histogram_functions.HistogramLiteralInt, 256, 512, 400.0, num_literals, mb.literal_split, mb.literal_histograms);
		//line 117 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.metablock.BlockSplitter cmd_blocks = new encode.metablock.BlockSplitter(encode.Histogram_functions.HistogramCommandInt, 704, 1024, 500.0, n_commands, mb.command_split, mb.command_histograms);
		//line 120 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.metablock.BlockSplitter dist_blocks = new encode.metablock.BlockSplitter(encode.Histogram_functions.HistogramDistanceInt, 64, 512, 100.0, n_commands, mb.distance_split, mb.distance_histograms);
		//line 124 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 124 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g11 = 0;
			//line 124 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g11 < n_commands ))
			{
				//line 124 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i1 = _g11++;
				//line 125 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				encode.command.Command cmd = commands.__get(i1);
				//line 126 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				cmd_blocks.AddSymbol(((int) (haxe.lang.Runtime.toInt(cmd.cmd_prefix_.__get(0))) ));
				//line 127 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				{
					//line 127 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g3 = 0;
					//line 127 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g2 = cmd.insert_len_;
					//line 127 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					while (( _g3 < _g2 ))
					{
						//line 127 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						 ++ _g3;
						//line 128 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						lit_blocks.AddSymbol(((int) (((int[]) (ringbuffer) )[( pos & mask )]) ));
						//line 129 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						 ++ pos;
					}
					
				}
				
				//line 131 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				pos += cmd.copy_len_;
				//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				boolean tmp = false;
				//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				if (( cmd.copy_len_ > 0 )) 
				{
					//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int a = ((int) (haxe.lang.Runtime.toInt(cmd.cmd_prefix_.__get(0))) );
					//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					boolean aNeg = ( ((int) (a) ) < 0 );
					//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					if (( aNeg != false )) 
					{
						//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						tmp = aNeg;
					}
					else
					{
						//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						tmp = ( ((int) (a) ) >= ((int) (128) ) );
					}
					
				}
				else
				{
					//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					tmp = false;
				}
				
				//line 132 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				if (tmp) 
				{
					//line 133 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					dist_blocks.AddSymbol(((int) (haxe.lang.Runtime.toInt(cmd.dist_prefix_.__get(0))) ));
				}
				
			}
			
		}
		
		//line 137 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		lit_blocks.FinishBlock(true);
		//line 138 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		cmd_blocks.FinishBlock(true);
		//line 139 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		dist_blocks.FinishBlock(true);
	}
	
	
	public static void BuildMetaBlockGreedyWithContexts(int[] ringbuffer, int pos, int mask, int prev_byte, int prev_byte2, int literal_context_mode, int num_contexts, haxe.root.Array<java.lang.Object> static_context_map, haxe.root.Array<encode.command.Command> commands, int n_commands, encode.metablock.MetaBlockSplit mb)
	{
		//line 153 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int num_literals = 0;
		//line 154 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 154 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g1 = 0;
			//line 154 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g1 < n_commands ))
			{
				//line 154 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i = _g1++;
				//line 155 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				num_literals += commands.__get(i).insert_len_;
			}
			
		}
		
		//line 158 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.metablock.ContextBlockSplitter lit_blocks = new encode.metablock.ContextBlockSplitter(encode.Histogram_functions.HistogramLiteralInt, 256, num_contexts, 512, 400.0, num_literals, mb.literal_split, mb.literal_histograms);
		//line 161 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.metablock.BlockSplitter cmd_blocks = new encode.metablock.BlockSplitter(encode.Histogram_functions.HistogramCommandInt, 704, 1024, 500.0, n_commands, mb.command_split, mb.command_histograms);
		//line 164 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		encode.metablock.BlockSplitter dist_blocks = new encode.metablock.BlockSplitter(encode.Histogram_functions.HistogramDistanceInt, 64, 512, 100.0, n_commands, mb.distance_split, mb.distance_histograms);
		//line 168 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 168 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g11 = 0;
			//line 168 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g11 < n_commands ))
			{
				//line 168 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i1 = _g11++;
				//line 169 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				encode.command.Command cmd = commands.__get(i1);
				//line 170 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				cmd_blocks.AddSymbol(((int) (haxe.lang.Runtime.toInt(cmd.cmd_prefix_.__get(0))) ));
				//line 171 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				{
					//line 171 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g3 = 0;
					//line 171 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g2 = cmd.insert_len_;
					//line 171 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					while (( _g3 < _g2 ))
					{
						//line 171 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						 ++ _g3;
						//line 172 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						int context = encode.Context.ContextFunction(prev_byte, prev_byte2, literal_context_mode);
						//line 173 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						int literal = ((int) (((int[]) (ringbuffer) )[( pos & mask )]) );
						//line 174 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						lit_blocks.AddSymbol(literal, ((int) (haxe.lang.Runtime.toInt(static_context_map.__get(context))) ));
						//line 175 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						prev_byte2 = prev_byte;
						//line 176 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						prev_byte = literal;
						//line 177 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						 ++ pos;
					}
					
				}
				
				//line 179 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				pos += cmd.copy_len_;
				//line 180 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				if (( cmd.copy_len_ > 0 )) 
				{
					//line 181 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					prev_byte2 = ((int) (((int[]) (ringbuffer) )[( ( pos - 2 ) & mask )]) );
					//line 182 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					prev_byte = ((int) (((int[]) (ringbuffer) )[( ( pos - 1 ) & mask )]) );
					//line 183 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int cmd_prefix_ = ((int) (haxe.lang.Runtime.toInt(cmd.cmd_prefix_.__get(0))) );
					//line 184 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					if (( cmd_prefix_ >= 128 )) 
					{
						//line 185 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						dist_blocks.AddSymbol(((int) (haxe.lang.Runtime.toInt(cmd.dist_prefix_.__get(0))) ));
					}
					
				}
				
			}
			
		}
		
		//line 190 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		lit_blocks.FinishBlock(true);
		//line 191 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		cmd_blocks.FinishBlock(true);
		//line 192 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		dist_blocks.FinishBlock(true);
		//line 194 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		mb.literal_context_map = haxe.root.FunctionMalloc.mallocInt(( mb.literal_split.num_types << 6 ));
		//line 196 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 196 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g12 = 0;
			//line 196 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g = mb.literal_split.num_types;
			//line 196 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g12 < _g ))
			{
				//line 196 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i2 = _g12++;
				//line 197 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				{
					//line 197 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					int _g31 = 0;
					//line 197 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
					while (( _g31 < 64 ))
					{
						//line 197 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						int j = _g31++;
						//line 198 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
						((int[]) (mb.literal_context_map) )[( (( i2 << 6 )) + j )] = ( ( i2 * num_contexts ) + ((int) (haxe.lang.Runtime.toInt(static_context_map.__get(j))) ) );
					}
					
				}
				
			}
			
		}
		
	}
	
	
	public static void OptimizeHistograms(int num_direct_distance_codes, int distance_postfix_bits, encode.metablock.MetaBlockSplit mb)
	{
		//line 207 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 207 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g1 = 0;
			//line 207 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g = mb.literal_histograms.length;
			//line 207 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g1 < _g ))
			{
				//line 207 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i = _g1++;
				//line 208 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				encode.Entropy_encode.OptimizeHuffmanCountsForRle(256, mb.literal_histograms.__get(i).data_);
			}
			
		}
		
		//line 210 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 210 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g11 = 0;
			//line 210 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g2 = mb.command_histograms.length;
			//line 210 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g11 < _g2 ))
			{
				//line 210 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i1 = _g11++;
				//line 211 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				encode.Entropy_encode.OptimizeHuffmanCountsForRle(704, mb.command_histograms.__get(i1).data_);
			}
			
		}
		
		//line 214 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		int num_distance_codes = ( ( 16 + num_direct_distance_codes ) + (( 48 << distance_postfix_bits )) );
		//line 217 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
		{
			//line 217 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g12 = 0;
			//line 217 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			int _g3 = mb.distance_histograms.length;
			//line 217 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
			while (( _g12 < _g3 ))
			{
				//line 217 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				int i2 = _g12++;
				//line 218 "C:\\Users\\Dominik\\Brotli\\src\\encode\\Metablock.hx"
				encode.Entropy_encode.OptimizeHuffmanCountsForRle(num_distance_codes, mb.distance_histograms.__get(i2).data_);
			}
			
		}
		
	}
	
	
}


